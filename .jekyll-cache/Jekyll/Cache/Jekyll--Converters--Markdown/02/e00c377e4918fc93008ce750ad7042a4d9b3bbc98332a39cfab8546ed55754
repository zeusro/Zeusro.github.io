I"¹#<h2 id="bean-validation-è§„èŒƒå†…åµŒçš„çº¦æŸæ³¨è§£å®šä¹‰">Bean Validation è§„èŒƒå†…åµŒçš„çº¦æŸæ³¨è§£å®šä¹‰</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>çº¦æŸæ³¨è§£åç§°	çº¦æŸæ³¨è§£è¯´æ˜
@Null	éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ºç©º
@NotNull	éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ºéç©º
@AssertTrue	éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º true
@AssertFalse	éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º false
@Min	éªŒè¯ Number å’Œ String å¯¹è±¡æ˜¯å¦å¤§ç­‰äºæŒ‡å®šçš„å€¼
@Max	éªŒè¯ Number å’Œ String å¯¹è±¡æ˜¯å¦å°ç­‰äºæŒ‡å®šçš„å€¼
@DecimalMin	éªŒè¯ Number å’Œ String å¯¹è±¡æ˜¯å¦å¤§ç­‰äºæŒ‡å®šçš„å€¼ï¼Œå°æ•°å­˜åœ¨ç²¾åº¦
@DecimalMax	éªŒè¯ Number å’Œ String å¯¹è±¡æ˜¯å¦å°ç­‰äºæŒ‡å®šçš„å€¼ï¼Œå°æ•°å­˜åœ¨ç²¾åº¦
@Size	éªŒè¯å¯¹è±¡ï¼ˆArray,Collection,Map,Stringï¼‰é•¿åº¦æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´ä¹‹å†…
@Digits	éªŒè¯ Number å’Œ String çš„æ„æˆæ˜¯å¦åˆæ³•
@Past	éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å‰
@Future	éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å
@Pattern	éªŒè¯ String å¯¹è±¡æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="querystringæ¥æ”¶å‚æ•°-post-formæ¥æ”¶å‚æ•°">querystringæ¥æ”¶å‚æ•°/ POST Formæ¥æ”¶å‚æ•°</h2>
<p>è¿™ä¸¤ç§åˆåœ¨ä¸€èµ·å†™æ˜¯å› ä¸ºä»–ä»¬æ¥æ”¶çš„æ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„,å¯ä»¥ç”¨å¤šä¸ªå­—æ®µåˆ†å¼€æ¥æ”¶</p>

<ul>
  <li>å…¸å‹çš„POST Multi Form ç¤ºä¾‹</li>
</ul>

<pre><code class="language-JAVA">@Validated
@RestController
public class PictureAPIs {
    public ApiResult add(@RequestParam("file") MultipartFile file,
                         @NotNull(message = "xxxä¸å¾—ä¸ºç©º!")
                         @Size(min = 32, max = 32, message = "å¿…é¡»æ˜¯32ä½çš„å­—ç¬¦ä¸²")
                         @RequestParam String gidUnique,                         
                         @Pattern(regexp = "^(taobao_picture_upload|taobao_product_img_upload|taobao_item_img_upload|taobao_product_add)$",message = "typeå¯é€‰å€¼:XXX")
                         @RequestParam("type") String type,                         
                         @RequestParam("i") String i) {
                         }
}
</code></pre>

<ul>
  <li>
    <p>@Validated
@Validatedæ˜¯æœ€é‡è¦çš„,åœ¨æ¯ä¸ªéœ€è¦éªŒè¯æ§åˆ¶å™¨å‚æ•°çš„ API ä¸Šé¢éƒ½éœ€è¦åŠ ä¸Šè¿™ä¸ªæ³¨è§£</p>
  </li>
  <li>
    <p>@RequestParam
è¿™ä¸ªæ˜¯å¾ˆé‡è¦çš„,æ¯ä¸ªæäº¤çš„å‚æ•°éƒ½éœ€è¦åŠ ä¸Šè¿™ä¸ªæ ‡ç­¾<code class="highlighter-rouge">@RequestParam("file")</code>è¡¨ç¤ºæ¥æ”¶ name=file çš„å‚æ•°æäº¤.</p>
  </li>
  <li>
    <p>@NotNull
éç©ºéªŒè¯,è¿™ä¸ªå¾ˆå¸¸è§</p>
  </li>
  <li>
    <p>@Size
å­—ç¬¦ä¸²é•¿åº¦ä¸Šä¸‹é™</p>
  </li>
  <li>
    <p>@Pattern
æ­£åˆ™</p>
  </li>
</ul>

<h2 id="æ¥æ”¶jsonå‚æ•°">æ¥æ”¶JSONå‚æ•°</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/api/picture/add/base64"</span><span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json;charset=UTF-8"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ApiResult</span> <span class="nf">add</span><span class="o">(</span>
            <span class="nd">@Validated</span>
            <span class="nd">@RequestBody</span> <span class="nc">PictureAddBase64RequestBody</span> <span class="n">body</span><span class="o">,</span>
            <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="nc">CookieMessageConst</span><span class="o">.</span><span class="na">ACCESS_TOKEN_KEY</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PictureAddBase64RequestBody</span> <span class="kd">extends</span> <span class="nc">PictureAddBaseRequestBody</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">6185318090948651724L</span><span class="o">;</span>
    <span class="nd">@NotNull</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">"base64ä¸å¾—ä¸ºç©º!"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">base64</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getBase64</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBase64</span><span class="o">(</span><span class="nc">String</span> <span class="n">base64</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">base64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ä»¥è¿™ä¸ªä¸ºä¾‹,å‚æ•°çš„æ ¡éªŒæ ‡ç­¾æ”¾åœ¨PictureAddBase64RequestBodyçš„å­—æ®µä¸Šé¢</p>

<h2 id="å…¶ä»–">å…¶ä»–</h2>

<ul>
  <li>éªŒè¯æ–¹æ³•</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre> <span class="c1">//éªŒè¯ </span>
 <span class="kd">public</span> <span class="kd">static</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">(</span><span class="no">T</span> <span class="n">t</span><span class="o">){</span> 
     <span class="nc">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">getValidator</span><span class="o">();</span>
      <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">constraintViolations</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">t</span><span class="o">);</span> 
      <span class="k">for</span><span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">constraintViolation</span> <span class="o">:</span> <span class="n">constraintViolations</span><span class="o">)</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">constraintViolation</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span> <span class="o">}</span> <span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å‚è€ƒé“¾æ¥:</p>
<ol>
  <li><a href="https://www.jianshu.com/p/2e71656aa88c">è‡ªå®šä¹‰æ³¨è§£ä¸å‚æ•°éªŒè¯</a></li>
  <li><a href="https://www.jianshu.com/p/f9f9490a0924">Javaæ³¨è§£ + åŸºäºæ³¨è§£ &amp; æ‹¦æˆªå™¨å®ç°ç™»å½•éªŒè¯ / æƒé™æ§åˆ¶</a></li>
  <li><a href="https://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#validator-defineconstraints-spec">Bean Validation constraints</a></li>
  <li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-beanvalid/">Bean Validation æŠ€æœ¯è§„èŒƒç‰¹æ€§æ¦‚è¿°</a></li>
  <li><a href="http://jinnianshilongnian.iteye.com/blog/1733708">SpringMVCæ•°æ®éªŒè¯â€”â€”ç¬¬ä¸ƒç«  æ³¨è§£å¼æ§åˆ¶å™¨çš„æ•°æ®éªŒè¯ã€ç±»å‹è½¬æ¢åŠæ ¼å¼åŒ–â€”â€”è·Ÿç€å¼€æ¶›å­¦SpringMVC</a></li>
</ol>
:ET