I"<h2 id="缘由">缘由</h2>

<p>阿里云搞了个 <a href="https://developer.aliyun.com/special/apphubchallenge">云原生应用大赛</a> ,要求用 helm v3 提交代码,我就顺便提交几个 helm chart ,同时学学的 helm 的语法</p>

<h2 id="语法">语法</h2>

<p>目前(2019-07-26) v3还没正式 release,文档很少,学习的时候只能拿旧的文档对照踩坑.</p>

<p>v2 跟 v3 的差别不小:</p>

<ol>
  <li>取消了服务端;</li>
  <li>helm list 改用secret;</li>
  <li>很多命令已经不兼容,发生变化</li>
</ol>

<p>学习 helm 的蛋疼之处在于要弄明白他们的模板语法,模板语法包含一些内置函数,还有 <code class="highlighter-rouge">go template</code> 相关的一类东西.</p>

<p><a href="https://v3.helm.sh/docs/topics/chart_template_guide/variables/">Variables</a>
<a href="https://helm.sh/docs/charts_tips_and_tricks/#using-the-include-function">Chart Development Tips and Tricks</a></p>

<h2 id="提交的几个-chart">提交的几个 chart</h2>

<p><a href="https://github.com/cloudnativeapp/charts/pull/34">jekyll</a></p>

<p><a href="https://github.com/cloudnativeapp/charts/pull/33">hexo</a></p>

<p><a href="https://github.com/cloudnativeapp/charts/pull/39">codis</a></p>

<p>codis 花了比较多心血,大家给个辛苦费帮我在pr页面点赞吧~</p>

<h2 id="与kustomize-的不同">与<a href="https://kustomize.io/">kustomize</a> 的不同</h2>

<p>kustomize 一开始就是做成轻量级的 yaml 生成器,所以不存在服务端;</p>

<p>kustomize 的变量替换比较麻烦,需要用 json patch.</p>

<p>kustomize 没有控制流程,要高度定制比较麻烦.</p>

<p><code class="highlighter-rouge">Helm 3</code> 把已安装的 chart 信息存作 <code class="highlighter-rouge">type:helm.sh/release</code> 的 secret ,于是乎, <code class="highlighter-rouge">Helm 3</code> 支持在多个 namespace 安装相同名称的 release</p>
:ET